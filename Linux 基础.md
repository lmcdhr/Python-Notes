# Linux 基础
#骆牧成到此一游哈哈哈哈哈哈哈哈哈哈哈
## A. 常用 Linux 命令的基本使用

| 序号 | 命令           | 英文                 | 作用                     |
| ---- | -------------- | -------------------- | ------------------------ |
| 01   | ls             | list                 | 查看当前文件夹下的内容   |
| 02   | pwd            | print work directory | 查看当前所在文件夹       |
| 03   | cd [目录名]    | change directory     | 切换文件夹               |
| 04   | touch [文件名] | touch                | 如果文件不存在则新建文件 |
| 05   | mkdir          | make directory       | 创建目录                 |
| 06   | rm [文件名]    | remove               | 删除指定文件名的文件     |
| 07   | clear          | clear                | 清屏                     |

**Trick:**

* 使用`Ctrl + Shift + =`放大终端字体
* 使用`Ctrl + -`缩小终端字体

## B. Linux 终端命令格式

`command [-options] [parameter]`

**说明：**

* `command`：命令名，相应功能英文单词或缩写
* `[-options]`：选项，对命令进行控制，可以省略
* `[parameter]`：传给命令的参数，可以是零个、一个或者多个

**查询命令帮助信息：**

1. **--help**

   `command -- help`

   **说明：**

   显示`command`命令的帮助信息

2. **man**

   `man command`

   **说明：**

   查阅`command`命令的使用手册

   使用`man`时的操作键：

   | 操作键 | 功能                 |
   | ------ | -------------------- |
   | 空格键 | 显示手册页的下一屏   |
   | Enter  | 一次滚动手册页的一行 |
   | b      | 回滚一屏             |
   | f      | 前滚一屏             |
   | q      | 退出                 |
   | /word  | 搜索**word**字符串   |

## C. 文件和目录常用命令

### 目标

- 查看目录内容
  - `ls`
- 切换目录
  - `cd`
- 创建和删除操作
  - `touch`
  - `rm`
  - `mkdir`
- 拷贝和移动文件
  - `cp`
  - `mv`
- 查看文件内容
  - `cat`
  - `more`
  - `grep`
- 其它
  - `echo`
  - 重定向`>`和`>>`
  - 管道`|`

### 01. 查看目录内容

#### 1.1 终端实用技巧

##### 自动补全

* 在敲出`文件`/`目录`/`命令`的前几个字母后按下`tab`键进行自动补全
  * 如果输入没有歧义，则系统会自动补全
  * 如果存在歧义，系统会提示可选的命令

##### 曾经使用过的命令

* 按`上`/`下`光标键可以在曾经使用过的命令之间来回切换
* 如果想要退出选择，并且不执行当前选中的命令，可以按`Ctrl + C`

#### 1.2 ls 命令说明

* `ls`是英文单词**list**的缩写，其功能为列出目录内容，类似于**DOS**下的`dir`命令

##### Linux 下文件和目录的特点

* Linux **文件**或**目录**名称最长可以有`256`个字符
* 以`.`开头的文件为隐藏文件，需要用`-a`选项才能显示
* `.`代表当前目录
* `..`代表上一级目录

#### 1.3 ls 常用选项

| 参数 | 含义                                         |
| ---- | -------------------------------------------- |
| -a   | 显示当前目录下所有子目录与文件，包括隐藏文件 |
| -l   | 以列表方式显示文件的详细信息                 |
| -h   | 配合`-l`使用以更人性化的方式显示文件大小     |

#### 1.4 通配符的使用

| 通配符 | 含义                    |
| ------ | ----------------------- |
| *      | 代表任意个数的字符      |
| ？     | 代表任意字符，至少一个  |
| []     | 匹配字符组中的任意一个  |
| [abc]  | 匹配a、b、c中的任意一个 |
| [a-f]  | 匹配a到f中的任意一个    |

**注意：**文件扩展名也是文件名的一部分

### 02. 切换目录

#### 2.1 cd

* `cd`是英文单词 **change directory** 的缩写，其功能为改变当前的工作目录

| 命令  | 含义                                     |
| ----- | ---------------------------------------- |
| cd    | 切换到当前用户的主目录（/home/用户目录） |
| cd ~  | 切换到当前用户的主目录（/home/用户目录） |
| cd .  | 保持在当前目录不变                       |
| cd .. | 切换到上级目录                           |
| cd -  | 在最近两次工作目录间来回切换             |

#### 2.2 相对路径和绝对路径

* **相对路径：** 在输入路径时，最前面不是/或者~，表示从当前目录开始的目录位置
* **绝对路径：** 在输入路径时，以/或者~开始，表示从根目录/家目录开始的目录位置

### 03. 创建和删除操作

#### 3.1 touch

* 创建文件或修改文件时间
  * 如果文件 **不存在**，可以创建一个空白文件
  * 如果文件 **已经存在**，可以修改文件的末次修改日期

#### 3.2 mkdir

* 创建一个新的目录

| 选项 | 含义             |
| ---- | ---------------- |
| -p   | 可以递归创建目录 |

> 新建目录的名称不能与当前目录中已有的目录或文件重名

#### 3.3 rm

* 删除文件或目录

> 使用时必须小心，因为删除后不能恢复

| 选项 | 含义                                               |
| ---- | -------------------------------------------------- |
| -f   | 强制删除，忽略不存在的文件，无需提示               |
| -r   | 递归地删除目录下的内容，删除文件夹时必须使用此参数 |

### 04. 拷贝和移动文件

| 序号 | 命令               | 对应英文 | 作用                                |
| ---- | ------------------ | -------- | ----------------------------------- |
| 01   | tree [目录名]      | tree     | 以树状图列出文件目录结构            |
| 02   | cp 源文件 目标文件 | copy     | 复制文件或者目录                    |
| 03   | mv 源文件 目标文件 | move     | 移动文件或者目录/文件或者目录重命名 |

#### 4.1 tree

* `tree`命令可以以树状图列出文件目录结构

| 选项 | 含义       |
| ---- | ---------- |
| -d   | 只显示目录 |

#### 4.2 cp

* `cp`命令的功能是将给出的文件或者目录复制到另一个文件或者目录中，相当于DOS下的`copy`命令

| 选项 | 含义                                                         |
| ---- | ------------------------------------------------------------ |
| -f   | 已经存在的目标文件直接覆盖，不会提示                         |
| -i   | 覆盖文件前提示                                               |
| -r   | 若给出的源文件时目录文件，则cp将递归复制该目录下所有子目录和文件，目标文件必须为一个目录 |

#### 4.3 mv

* `mv`命令可以用来移动文件和目录，也可以给文件或目录重命名

| 选项 | 含义           |
| ---- | -------------- |
| -i   | 覆盖文件前提示 |

### 05. 查看文件内容

| 序号 | 命令                 | 对应英文    | 作用                                                 |
| ---- | -------------------- | ----------- | ---------------------------------------------------- |
| 01   | cat 文件名           | concatenate | 查看文件内容、创建文件、文件合并、追加文件内容等功能 |
| 02   | more 文件名          | more        | 分屏显示文件内容                                     |
| 03   | grep 搜索文本 文件名 | grep        | 搜索文本文件内容                                     |

#### 5.1 cat

* `cat`命令可以用来查看文件内容、创建文件、文件合并、追加文件内容等功能
* `cat`会一次显示所有的内容，适合查看内容较少的文本文件

| 选项 | 含义               |
| ---- | ------------------ |
| -b   | 对非空输出行编号   |
| -n   | 对输出的所有行编号 |

> Linux 中`nl`命令和`cat -b`等价

#### 5.2 more

* `more`命令可以用于分屏显示文件内容，每次只显示一页内容
* 适合查看内容较多的文件

`more`操作键

| 操作键 | 功能                |
| ------ | ------------------- |
| 空格键 | 显示下一屏          |
| Enter  | 一次滚动一行        |
| b      | 回滚一屏            |
| f      | 前滚一屏            |
| q      | 退出                |
| /word  | 搜索 **word**字符串 |

#### 5.3 grep

* Linux 系统中`grep`命令是一种强大的文本搜索工具
* `grep`允许对文本文件进行模式查找，又被称为正则表达式（留到后面在讲）

| 选项 | 含义                                     |
| ---- | ---------------------------------------- |
| -n   | 显示匹配行及行号                         |
| -v   | 显示不包含匹配文本的所有行（相当于求反） |
| -i   | 忽略大小写                               |

* 两种常用的模式查找

| 参数 | 含义                   |
| ---- | ---------------------- |
| ^a   | 行首，搜索以a开头的行  |
| ke$  | 行尾，搜索以ke结束的行 |

### 06. 其它

#### 6.1 echo 文字内容

* `echo`会在终端中显示参数文字，通常会和 **重定向**配合使用，例如`echo "Hello Python" > hello.txt`可以将Hello Python输出到hello.txt文件中

#### 6.2 重定向 > 和 >>

* Linux 允许将命令执行结果 **重定向**到一个文件
* 将本应显示在终端上的内容 **输出/追加**到指定文件中

其中

* `>`表示输出，会覆盖文件原有的内容
* `>>`表示追加，会将内容追加到已有文件的末尾

#### 6.3 管道 |

* Linux 允许将 **一个命令的输出**通过 **管道**作为 **另一个命令的输入**
* `|`左端写，右端读

常用的管道命令有：

* `more`：分屏显示内容，例如`ls -lh ~ | more`
* `grep`：在命令执行结果基础上查询指定文本

## D. 远程管理常用命令

### 目标

* 关机/重启
  * `shutdown`
* 查看或配置网卡信息
  * `ifconfig`
  * `ping`
* 远程登陆和复制文件
  * `ssh`
  * `scp`

### 01. 关机/重启

| 序号 | 命令               | 对应英文 | 作用          |
| ---- | ------------------ | -------- | ------------- |
| 01   | shutdown 选项 时间 | shutdown | 关机/重新启动 |

#### 1.1 shutdown

* `shutdown`命令可以安全关闭或者重新启动系统

| 选项 | 重新启动 |
| ---- | -------- |
| -r   | 重新启动 |

> * 如果不指定选项和参数，默认 **1分钟**后 **关闭电脑**
> * 远程维护服务器时，最好不要关闭系统，而应该重新启动系统

```
# 重新启动操作系统，其中 now 表示立刻
$ shutdown -r now

# 立刻关机
$ shudown now

# 系统在今天的 20:25 关机
$ shutdown 20:25

# 系统再过十分钟关机
$ shutdown +10

# 取消之前指定的关机计划
$shutdown -c
```

### 02. 查看或配置网卡信息

| 序号 | 命令        | 对应英文                      | 作用                              |
| ---- | ----------- | ----------------------------- | --------------------------------- |
| 01   | ifconfig    | configure a network interface | 查看/配置计算机当前的网卡配置信息 |
| 02   | ping ip地址 | ping                          | 检测到目标 ip地址 的连接是否正常  |

#### 2.1网卡和IP地址

##### 网卡

* 网卡是一个专门负责网络通讯的硬件设备
* IP地址是设置在网卡上的地址信息

##### IP地址

* 每台联网的电脑上都有IP地址，是保证电脑之间正常通讯的重要设置

#### 2.2 ifconfig

* `ifconfig`可以查看/配置计算机当前的网卡配置信息

```
# 查看网卡的配置信息
$ ifconfig

# 查看网卡对应的IP地址
$ ifconfig | grep inet
```

> 一台计算机中可能会有一个 **物理网卡**和多个 **虚拟网卡**，在Linux中物理网卡的名字通常以`ensXX`表示

* `127.0.0.1`被称为 **本地回环/回环地址**，一般用来测试本机网卡是否正常

#### 2.3 ping

```
# 检测到目标主机的连接是否正常
$ ping IP地址

# 检测本地网卡工作是否正常
$ ping 127.0.0.1
```

* `ping`一般用于检测当前计算机到目标计算机之间的网络是否通畅，**数值越大，速度越慢**

> * `ping`的工作原理类似于潜艇声纳，这也是其名称的来历
> * 网络管理员也将其用作动词—— *”ping 一下计算机X，看它是否开着“*

##### 原理

向目标IP地址发送一个数据包，对方也会返回一个数据包，根据返回的数据包和时间，就可以确定目标主机的存在

### 03.远程登陆和复制文件

| 序号 | 命令                                              | 对应英文     | 作用          |
| ---- | ------------------------------------------------- | ------------ | ------------- |
| 01   | ssh 用户名@IP                                     | secure shell | 关机/重新启动 |
| 02   | scp 用户名@IP:文件名或路径 用户名@IP:文件名或路径 | secure copy  | 远程复制文件  |

#### 3.1 ssh 基础（重点）

在 Linux 中 SSH 是非常常用的工具，通过 SSH 客服端可以连接到运行了 SSH 服务器的远程主机上

* **SSH 客户端**是一种使用`secure shell (SSH)`协议连接到远程计算机的软件程序
* `SSH`是目前较可靠，**专为远程登录会话和其它网络服务**提供安全性的协议
  * 利用`SSH协议`可以有效防止 **远程管理过程中的信息泄露**
  * 通过`SSH协议`可以对所有传输的数据进行加密，防止 **DNS欺骗**和 **IP欺骗**
* `SSH`的另一项优点是传输的数据是可以经过压缩的，可以加快传输的速度

##### 1. 域名和端口号

**域名**

* 由一串用点分隔的名字组成，如`www.google.com`
* 是IP地址的别名，方便用户记忆

**端口号**

* 通过IP地址找到网络上的计算机
* 通过 **端口号**找到计算机上运行的应用程序
  * **SSH服务器**的默认端口号是`22`，如果是默认端口号，在连接时可以省略

| 序号 | 服务      | 端口号 |
| ---- | --------- | ------ |
| 01   | SSH服务器 | 22     |
| 02   | Web服务器 | 80     |
| 03   | HTTPS     | 443    |
| 04   | FTP服务器 | 21     |

##### 2. SSH客户端的简单使用

`ssh [-p port] user@remote`

* `user`是在远程计算机上的用户名，如果不指定则默认为当前用户
* `remote`是远程计算机的地址，可以是IP/域名，或者是后面会提到的别名
* `port`是 **SSH Server监听的端口**，如果不指定，则默认为`22`

> **提示：**
>
> * 使用`exit`退出当前用户的登陆
>
> **注意：**
>
> * `ssh`这个终端命令只能在`Linux`或者`UNIX`系统下使用
> * 如果在`Windows`系统中，可以安装`PuTTY`或者`XShell`客服端
>
> **提示：**
>
> * 在工作中，SSH服务器的端口号可能不是22，此时必须使用`-p`选项，指定正确的端口号

#### 3.2 scp（掌握）

```
# 把本地当前目录下的 01.py 文件 复制到 远程 家目录下的 Desktop/01.py
# 注意：`:` 后面的路径如果不是绝对路径，则以用户的家目录作为参照路径
scp -P port 01.py user@remote:Desktop/01.py

# 把远程 家目录下的 Desktop/01.py 文件 复制到 本地当前目录下的 01.py
scp -P port user@remote:Desktop/01.py 01.py

# 加上 -r 选项可以传送文件夹
# 把当前目录下的 demo 文件夹 复制到 远程 家目录下的 Desktop
scp -r demo user@remote:Desktop

# 把远程 家目录下的 Desktop 复制到 当前目录下的 demo 文件夹
scp -r user@remote:Desktop demo
```

| 选项 | 含义                                                         |
| ---- | ------------------------------------------------------------ |
| -r   | 若给出的源文件是目录文件，则 scp 将递归复制该目录下的所有子目录和文件，目标文件必须为一个目录名 |
| -P   | 若远程 SSH 服务器的端口不是 22，需要使用大写字母 -P 选项指定端口 |

> **注意：**
>
> * `SCP`命令只能在`Linux`或`UNIX`系统下使用
> * 在`Windows`系统中，可以安装`PuTTY`，使用`pscp`命令行工具或者安装`FileZilla`使用`FTP`进行文件传输

**FileZilla**

* `FileZilla`在传输文件时，使用的时`FTP服务`而非`SSH服务`，端口号应该设置为`21`

#### 3.3 SSH 高级（了解）

* 免密码登陆
* 配置别名

> 有关SSH的配置信息都保存在用户家目录下的`.ssh`目录下

##### 1. 免密码登陆

* 配置公钥
  * 执行`ssh-keygen`即可生成SSH钥匙，一路回车即可
* 上传公钥到服务器
  * 执行`ssh-copy-id -p port user@remote`可以让远程服务器记住我们的公钥

> **非对称加密算法**
>
> * 使用 **公钥**加密的数据，需要使用 **私钥**解密
> * 使用 **私钥**加密的数据，需要使用 **公钥**解密

##### 2. 配置别名

每次都输入`ssh -p port user@remote`繁琐且不便于记忆，这时可以配置别名，例如使用`ssh mac`作为替代指令，只需要在`~/.ssh/config`中追加

```
Host mac
	HostName ip地址
	User username
	Port 22
```

保存后即可使用`ssh mac`实现远程登陆了，该方法对`scp`同样适用
